generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model bank_accounts {
  id             Int       @id @default(autoincrement())
  user_id        Int?
  bank_name      String?   @db.VarChar(255)
  branch_name    String?   @db.VarChar(255)
  account_name   String?   @db.VarChar(50)
  account_number String?   @db.VarChar(50)
  account_type   String?   @db.VarChar(50)
  is_deleted     Boolean?  @default(false)
  deleted_at     DateTime? @db.Timestamp(6)
  created_at     DateTime? @default(now()) @db.Timestamp(6)
  updated_at     DateTime? @default(now()) @db.Timestamp(6)
  users          users?    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([user_id], map: "idx_bank_accounts_user_id")
  @@index([user_id, is_deleted], map: "idx_bank_accounts_user_id_is_deleted")
  @@index([is_deleted], map: "idx_bank_accounts_is_deleted")
}

model capital {
  id           Int       @id @default(autoincrement())
  capital_type String    @db.VarChar(100)
  amount       Decimal   @db.Decimal(14, 2)
  currency     String?   @default("USD") @db.VarChar(10)
  description  String?
  is_deleted   Boolean?  @default(false)
  deleted_at   DateTime? @db.Timestamp(6)
  created_at   DateTime? @default(now()) @db.Timestamp(6)
  updated_at   DateTime? @default(now()) @db.Timestamp(6)

  @@index([capital_type], map: "idx_capital_capital_type")
  @@index([currency], map: "idx_capital_currency")
  @@index([is_deleted], map: "idx_capital_is_deleted")
}

model documents {
  id            Int       @id @default(autoincrement())
  user_id       Int?
  document_type String?   @db.VarChar(100)
  file_url      String?
  verified      Boolean?  @default(false)
  is_deleted    Boolean?  @default(false)
  deleted_at    DateTime? @db.Timestamp(6)
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @default(now()) @db.Timestamp(6)
  users         users?    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([document_type], map: "idx_documents_document_type")
  @@index([user_id], map: "idx_documents_user_id")
  @@index([verified], map: "idx_documents_verified")
  @@index([is_deleted], map: "idx_documents_is_deleted")
}

model employments {
  id              Int       @id @default(autoincrement())
  user_id         Int?      @unique
  employer_name   String?   @db.VarChar(255)
  job_title       String?   @db.VarChar(100)
  employment_type String?   @db.VarChar(50)
  monthly_income  Decimal?  @db.Decimal(12, 2)
  payday_day      Int?
  is_deleted      Boolean?  @default(false)
  deleted_at      DateTime? @db.Timestamp(6)
  created_at      DateTime? @default(now()) @db.Timestamp(6)
  updated_at      DateTime? @default(now()) @db.Timestamp(6)

  @@index([employment_type], map: "idx_employments_employment_type")
  @@index([is_deleted], map: "idx_employments_is_deleted")
  @@index([user_id], map: "idx_employments_user_id")
}

model interest {
  id          Int       @id @default(autoincrement())
  loan_id     Int?
  type        String?   @db.VarChar(50)
  amount      Decimal?  @db.Decimal(12, 2)
  description String?
  is_deleted  Boolean?  @default(false)
  deleted_at  DateTime? @db.Timestamp(6)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
  loans       loans?    @relation(fields: [loan_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([loan_id], map: "idx_interest_loan_id")
  @@index([type], map: "idx_interest_type")
  @@index([is_deleted], map: "idx_interest_is_deleted")
}

model applications {
  id               Int           @id @default(autoincrement())
  user_id          Int?
  amount_requested Decimal?      @db.Decimal(12, 2)
  term_in_days     Int?
  purpose          String?
  status           String?       @default("pending")
  decision_reason  String?
  submitted_at     DateTime?     @default(now()) @db.Timestamp(6)
  decided_at       DateTime?     @db.Timestamp(6)
  is_deleted       Boolean?      @default(false)
  deleted_at       DateTime?     @db.Timestamp(6)
  created_at       DateTime?     @default(now()) @db.Timestamp(6)
  updated_at       DateTime?     @default(now()) @db.Timestamp(6)
  users            users?        @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  offers      offers[]

  @@index([status], map: "idx_applications_status")
  @@index([submitted_at], map: "idx_applications_submitted_at")
  @@index([user_id], map: "idx_applications_user_id")
  @@index([is_deleted], map: "idx_applications_is_deleted")
}

model offers {
  id                Int                @id @default(autoincrement())
  application_id    Int?
  principal         Decimal?           @db.Decimal(12, 2)
  interest_rate     Decimal?           @db.Decimal(5, 2)
  fee_amount        Decimal?           @db.Decimal(12, 2)
  repayment_date    DateTime?          @db.Date
  total_due         Decimal?           @db.Decimal(12, 2)
  offer_status      String?            @default("offered")
  is_deleted        Boolean?           @default(false)
  deleted_at        DateTime?          @db.Timestamp(6)
  created_at        DateTime?          @default(now()) @db.Timestamp(6)
  updated_at        DateTime?          @default(now()) @db.Timestamp(6)
  applications applications? @relation(fields: [application_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  loans             loans[]

  @@index([application_id], map: "idx_offers_application_id")
  @@index([offer_status], map: "idx_offers_offer_status")
  @@index([is_deleted], map: "idx_offers_is_deleted")
}

model loans {
  id                Int                 @id @default(autoincrement())
  user_id           Int?
  loan_offer_id     Int?
  status            String?             @default("active")
  disbursed_at      DateTime?           @db.Timestamp(6)
  due_date          DateTime?           @db.Date
  total_amount      Decimal?            @db.Decimal(12, 2)
  balance_remaining Decimal?            @db.Decimal(12, 2)
  is_deleted        Boolean?            @default(false)
  deleted_at        DateTime?           @db.Timestamp(6)
  created_at        DateTime?           @default(now()) @db.Timestamp(6)
  updated_at        DateTime?           @default(now()) @db.Timestamp(6)
  interest          interest[]
  offers       offers?        @relation(fields: [loan_offer_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users             users?              @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  repayments        repayments[]

  @@index([due_date], map: "idx_loans_due_date")
  @@index([loan_offer_id], map: "idx_loans_loan_offer_id")
  @@index([status], map: "idx_loans_status")
  @@index([user_id], map: "idx_loans_user_id")
  @@index([is_deleted], map: "idx_loans_is_deleted")
}

model notifications {
  id         Int       @id @default(autoincrement())
  user_id    Int?
  title      String?   @db.VarChar(255)
  message    String?
  read       Boolean?  @default(false)
  is_deleted Boolean?  @default(false)
  deleted_at DateTime? @db.Timestamp(6)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  users      users?    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([created_at], map: "idx_notifications_created_at")
  @@index([read], map: "idx_notifications_read")
  @@index([user_id], map: "idx_notifications_user_id")
  @@index([is_deleted], map: "idx_notifications_is_deleted")
}

model repayments {
  id                    Int       @id @default(autoincrement())
  loan_id               Int?
  amount_paid           Decimal?  @db.Decimal(12, 2)
  payment_date          DateTime? @db.Timestamp(6)
  payment_method        String?   @db.VarChar(50)
  transaction_reference String?   @db.VarChar(100)
  is_deleted            Boolean?  @default(false)
  deleted_at            DateTime? @db.Timestamp(6)
  created_at            DateTime? @default(now()) @db.Timestamp(6)
  updated_at            DateTime? @default(now()) @db.Timestamp(6)
  loans                 loans?    @relation(fields: [loan_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([loan_id], map: "idx_repayments_loan_id")
  @@index([payment_date], map: "idx_repayments_payment_date")
  @@index([transaction_reference], map: "idx_repayments_transaction_reference")
  @@index([is_deleted], map: "idx_repayments_is_deleted")
}

model settings {
  id          Int       @id @default(autoincrement())
  key         String    @unique @db.VarChar(100)
  value       String?
  description String?
  is_deleted  Boolean?  @default(false)
  deleted_at  DateTime? @db.Timestamp(6)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)

  @@index([is_deleted], map: "idx_settings_is_deleted")
}

model users {
  id                Int                 @id @default(autoincrement())
  identity          String              @unique @db.VarChar(255)
  first_name        String?             @db.VarChar(100)
  middle_name       String?             @db.VarChar(100)
  last_name         String?             @db.VarChar(100)
  email             String?             @db.VarChar(50)
  dob               DateTime?           @db.Date
  phone_number      String?             @db.VarChar(20)
  trn               String?             @db.VarChar(50)
  street_address    String?
  city              String?             @db.VarChar(100)
  country           String?             @db.VarChar(100)
  status            String?             @default("active")
  is_deleted        Boolean?            @default(false)
  deleted_at        DateTime?           @db.Timestamp(6)
  created_at        DateTime?           @default(now()) @db.Timestamp(6)
  updated_at        DateTime?           @default(now()) @db.Timestamp(6)
  bank_accounts     bank_accounts[]
  documents         documents[]
  applications      applications[]
  loans             loans[]
  notifications     notifications[]

  @@index([created_at], map: "idx_users_created_at")
  @@index([identity], map: "idx_users_identity")
  @@index([status], map: "idx_users_status")
  @@index([is_deleted], map: "idx_users_is_deleted")
  @@index([email], map: "idx_users_email")
}
